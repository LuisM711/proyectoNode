extends layout
block content
    .container.mt-5
      .row
        .col-md-6
          .card
            .card-header Control de Usuarios
            .card-body
              form(id="userForm", action="/guardarCambios", method="POST")
                .mb-3
                  label(for="idEmpleado", class="form-label") ID del Empleado
                  input(type="text", class="form-control", id="idEmpleado", name = "idEmpleado", placeholder="ID del empleado", readonly = true, required)
                .mb-3
                  label(for="username", class="form-label") Nombre de Usuario
                  input(type="text", class="form-control", id="username", name = "username", placeholder="Nombre de usuario", required)
                .mb-3
                  label(for="role", class="form-label") Rango
                  select.form-select#role(name="role", required)
                    each cargo in cargosData
                      option(value=cargo.IDCargos)= cargo.Cargos
                .mb-3.form-check
                  input(type="checkbox", class="form-check-input", id="active", name = "isActive")
                  label.form-check-label(for="active") Usuario Dado de Alta
                button(type="submit", class="btn btn-primary btn-block") Guardar Cambios
        .col-md-6
          table.table.table-striped
            thead
              tr
                th ID del Empleado
                th Nombre de Usuario
                th Rango
                th Usuario Dado de Alta
            tbody
              each empleado in empleadosData
                tr
                  td= empleado.IDEmp
                  td= empleado.Usuario
                  td= empleado.Rango
                  td= empleado.Alta ? 'Si' : 'No'
                  // Agrega más columnas para otros campos si es necesario

    // Agrega el enlace a los archivos JS de Bootstrap 5.0 (Bootstrap 5.0 ya no necesita jQuery)
    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js", integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4", crossorigin="anonymous")
    script.
      // Función para actualizar el formulario al hacer clic en una fila de la tabla
      const tableRows = document.querySelectorAll("tbody tr");
      const cargosData = !{JSON.stringify(cargosData)}; // Convierte cargosData a objeto JavaScript
      const empleadosData = !{JSON.stringify(empleadosData)}; // Convierte cargosData a objeto JavaScript
      tableRows.forEach((row) => {
        row.addEventListener("click", () => {
          const cells = row.querySelectorAll("td");
          document.getElementById("idEmpleado").value = cells[0].textContent;
          document.getElementById("username").value = cells[1].textContent;
          const IDEmp = cells[0].textContent;
          const empleadosMap = {};
          empleadosData.forEach((empleado) => {
            empleadosMap[empleado.IDEmp] = empleado.Cargo;
          });
          const cargoEncontrado = empleadosMap[IDEmp];
          document.getElementById("role").value = cargoEncontrado || "err"; // Establece el valor en el campo "Rango"
          document.getElementById("active").checked = cells[3].textContent === "Si";
        });
      });

